## Архитектура модели

- **Вход**: шахматная доска в формате FEN → преобразуется в тензор `(12, 8, 8)`.
  - 12 каналов: по 6 на белые и чёрные фигуры (пешка, конь, слон, ладья, ферзь, король).
- **Сеть**: простая свёрточная нейросеть (CNN):
  - 2 свёрточных слоя (64 фильтра, kernel=3, padding=1),
  - Dropout2d (0.2) для регуляризации свёрток,
  - Полносвязные слои: 4096 → 512 → 4096,
  - Dropout (0.5) перед выходом.
- **Выход**: logits для 4096 возможных ходов (from_square → to_square).
- **Маскировка**: при инференсе и оценке нелегальные ходы маскируются (вероятность = 0).


> **Ограничение**: превращения пешек кодируются упрощённо — все они интерпретируются как превращения в ферзя. Underpromotions (в ладью, слона или коня) не различаются на этапе обучения, но при выводе результатов модель пытается восстановить корректный тип превращения эвристически.


## Формат данных
Файл **fens_training_set.csv** должен содержать две колонки без заголовка: 
 
    "<fen_string>,<move_uci>
    rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1,e2e4
    ...
    "

Скрипт автоматически: 
  1. фильтрует некорректные FEN,
  2. проверяет легальность ходов,
  3. пропускает битые примеры.


## Запуск 

Обучение и оценка модели: 
  python modelChess.py

Пример вывода:

    Используется устройство: cpu
    До фильтрации: 268551 строк
    После фильтрации: 268549 строк
    Обучение
    Epoch 1/5, Avg Loss: 5.3255
    Epoch 2/5, Avg Loss: 4.0453
    Epoch 3/5, Avg Loss: 3.6415  
    Epoch 4/5, Avg Loss: 3.4080
    Epoch 5/5, Avg Loss: 3.2397
    Оценка на тесте:
    Test Top-1 Accuracy: 0.2683
    Test Top-3 Accuracy: 0.4706
      

Метрики качества

    Top-1 Accuracy: доля случаев, когда истинный ход — самый вероятный.
    Top-3 Accuracy: доля случаев, когда истинный ход в топ-3 предсказанных.
     

На датасете из ~260k ходов ожидаемая точность: 

    Top-1: 0.38–0.42
    Top-3: 0.63–0.68

    Значение Top-1 ≈ 0.27 может указывать на шум в данных или неоднородность стиля игроков.


## Дополнительная - описать, как будете решать задачу, как сыграет конкретный игрок - особенности игры/стиль, необходимое количество партий, будет ли модель по игроку отличаться от общей и как.
1) Добор предворительных данных одного игрока (300-500 партий)
2) Особенности стиля:
   2.1) Предпочтение дебюта
   2.2) Частота жертв, тактических ходов
   2.3) Склонность к атаке или позиционной игре
3) Подходы для решение:
  3.1) Дообучение текущей модели
  3.2) Новая CNN для партий больше 1000
